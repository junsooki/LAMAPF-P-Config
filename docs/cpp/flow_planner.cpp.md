# src/cpp/flow_planner.cpp

## 作用
构建时间展开网络、运行 Dinic、并从整数流中分解路径。

## 函数定义与作用

### PlanResult plan_flow(...)
- 作用：
  - 在窗口 `T` 内构建时间展开图并求解 max-flow
  - 允许在 `reserved` 指定的 (x,y,t) 上锁点（容量 0）
  - 目标点允许在任意 `t<=T` 被吸收（按时间吸收；不再作为“总容量 gate”限制跨时间总次数）
- 输入：
  - `grid`：0 可通行 / 1 障碍
  - `starts`：机器人起点坐标列表（必须可通行）
  - `targets`：目标点坐标列表（必须可通行）
  - `target_caps`：目标点容量（若为空默认每点 1；作用于每个时间层的吸收边）
  - `T`：时间窗口（0 表示只允许停留在起点）
  - `reserved`：禁止占用的时空点集合（超出 `T` 会忽略）
  - `reserved_edges`：禁止占用的时空边 (x1,y1,x2,y2,t)，用于避免对向交换
- 输出：
  - `feasible=true` 表示流量达到 `starts.size()`
  - `paths` 只在可行时保证完整，长度为到达目标时间步 + 1

## 约束/约定
- 处理点容量与边冲突（通过边节点拆分，限制同一时刻对向交换）。
- 移动规则：4 邻接 + 等待。
- 目标点采用“按时间吸收”机制：每个时间层可被占用一次（总次数不再受 gate 限制）。

### PlanResult plan_flow_sync(...)
- 作用：
  - 同步两段模型：强制所有机器人在时刻 `tau` 处于取货点集合 `pickups`
  - 在时刻 `T` 必须到达 `drops`（只在 `t=T` 吸收）
- 输入：
  - `pickups`：取货点集合（`tau` 时刻只允许这些点占用）
  - `drops`：卸货点集合（只允许 `t=T` 吸收）
  - `drop_caps`：卸货点容量（实际仍受点容量=1 限制）
  - `tau`：同步取货时刻（`0..T`）
- 输出：
  - `feasible=true` 表示满足同步约束并达到最大流
  - `paths` 只在可行时保证完整，长度为 `T+1`
